<!DOCTYPE html>
<html dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù¾Ù†Ù„ Ú©Ø§Ø±Ú¯Ø§Ù‡</title>
    <style>
        body { font-family: sans-serif; padding: 15px; background: #f4f4f4; }
        .card { background: white; padding: 15px; border-radius: 10px; border: 1px solid #ccc; }
        input { width: 70%; padding: 10px; margin-bottom: 10px; }
        button { padding: 10px; cursor: pointer; font-weight: bold; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th, td { border: 1px solid #333; padding: 10px; text-align: center; background: #fff; }
        .btn-add { background: #28a745; color: white; }
        .btn-backup { background: #007bff; color: white; margin-top: 20px; width: 100%; }
    </style>
</head>
<body>

<div class="card">
    <h3>ğŸ›  Ø«Ø¨Øª Ù¾Ø±ÙˆÚ˜Ù‡ Ùˆ Ù…Ø±Ø§Ø­Ù„</h3>
    <input type="text" id="pIn" placeholder="Ù†Ø§Ù… Ù¾Ø±ÙˆÚ˜Ù‡">
    <button class="btn-add" onclick="addP()">+ Ù¾Ø±ÙˆÚ˜Ù‡</button>
    <br>
    <input type="text" id="sIn" placeholder="Ù†Ø§Ù… Ù…Ø±Ø­Ù„Ù‡">
    <button class="btn-add" style="background:#17a2b8" onclick="addS()">+ Ù…Ø±Ø­Ù„Ù‡</button>

    <div style="overflow-x: auto;">
        <table id="myTable">
            <thead id="head"></thead>
            <tbody id="body"></tbody>
        </table>
    </div>

    <button class="btn-backup" onclick="exportData()">ğŸ’¾ Ø¯Ø§Ù†Ù„ÙˆØ¯ ÙØ§ÛŒÙ„ Ù¾Ø´ØªÛŒØ¨Ø§Ù† (Cloud Backup)</button>
</div>

<script>
    // Ú©Ù„ÛŒØ¯ Ø§Ø®ØªØµØ§ØµÛŒ Ø¨Ø±Ø§ÛŒ Ø­Ø§ÙØ¸Ù‡
    var ST = JSON.parse(localStorage.getItem('ST_STORE')) || [];
    var PR = JSON.parse(localStorage.getItem('PR_STORE')) || [];

    function refresh() {
        localStorage.setItem('ST_STORE', JSON.stringify(ST));
        localStorage.setItem('PR_STORE', JSON.stringify(PR));

        // Ø±Ù†Ø¯Ø± Ø³Ø±ØªÛŒØªØ±Ù‡Ø§
        var h = document.getElementById('head');
        h.innerHTML = '<tr><th>Ù†Ø§Ù… Ù¾Ø±ÙˆÚ˜Ù‡</th>' + ST.map(s => '<th>' + s + '</th>').join('') + '</tr>';

        // Ø±Ù†Ø¯Ø± Ø±Ø¯ÛŒÙâ€ŒÙ‡Ø§
        var b = document.getElementById('body');
        b.innerHTML = '';
        PR.forEach((p, pi) => {
            var row = '<tr><td><b>' + p.n + '</b></td>';
            ST.forEach((s, si) => {
                var d = p.d[si] || '';
                row += '<td onclick="update('+pi+','+si+')">' + d + '</td>';
            });
            row += '</tr>';
            b.innerHTML += row;
        });
    }

    function addP() {
        var v = document.getElementById('pIn').value;
        if(v) { PR.push({n:v, d:{}}); document.getElementById('pIn').value=''; refresh(); }
    }

    function addS() {
        var v = document.getElementById('sIn').value;
        if(v) { ST.push(v); document.getElementById('sIn').value=''; refresh(); }
    }

    function update(pi, si) {
        var txt = prompt("Ú¯Ø²Ø§Ø±Ø´ Ø¬Ø¯ÛŒØ¯:");
        if(txt !== null) {
            var now = new Date();
            var time = now.toLocaleDateString('fa-IR') + ' (' + now.getHours() + ':' + now.getMinutes() + ')';
            PR[pi].d[si] = time + ": " + txt + "<br>" + (PR[pi].d[si] || "");
            refresh();
        }
    }

    function exportData() {
        var data = JSON.stringify({ST, PR});
        var blob = new Blob([data], {type: "application/json"});
        var a = document.createElement("a");
        a.href = URL.createObjectURL(blob);
        a.download = "workshop_backup.json";
        a.click();
        alert("ÙØ§ÛŒÙ„ Ù¾Ø´ØªÛŒØ¨Ø§Ù† Ø¯Ø§Ù†Ù„ÙˆØ¯ Ø´Ø¯. Ø¢Ù† Ø±Ø§ Ø¯Ø± ØªÙ„Ú¯Ø±Ø§Ù… ÛŒØ§ Ø§ÛŒÙ…ÛŒÙ„ Ø®ÙˆØ¯ Ø°Ø®ÛŒØ±Ù‡ Ú©Ù†ÛŒØ¯.");
    }

    refresh();
</script>
</body>
</html>
