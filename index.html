<!DOCTYPE html>
<html dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        body { font-family: Tahoma; padding: 10px; direction: rtl; background: #eee; }
        .card { background: #fff; padding: 15px; border-radius: 8px; box-shadow: 0 2px 5px #ccc; }
        input { width: 60%; padding: 8px; margin: 5px 0; }
        button { padding: 8px 12px; cursor: pointer; border: none; border-radius: 4px; font-weight: bold; }
        table { width: 100%; border-collapse: collapse; margin-top: 15px; background: #fff; }
        th, td { border: 1px solid #000; padding: 8px; text-align: center; font-size: 13px; }
        th { background: #444; color: #fff; position: relative; }
        .p-done { background: #c8e6c9 !important; }
        .s-done { background: #e3f2fd; border: 2px solid blue !important; }
        .edit-hint { font-size: 9px; display: block; color: #ffeb3b; cursor: pointer; }
    </style>
</head>
<body>

<div class="card">
    <input type="text" id="pi" placeholder="Ù†Ø§Ù… Ù¾Ø±ÙˆÚ˜Ù‡ Ø¬Ø¯ÛŒØ¯">
    <button onclick="addP()" style="background:green; color:#fff">+ Ù¾Ø±ÙˆÚ˜Ù‡</button>
    <br>
    <input type="text" id="si" placeholder="Ù†Ø§Ù… Ù…Ø±Ø­Ù„Ù‡ Ø¬Ø¯ÛŒØ¯">
    <button onclick="addS()" style="background:blue; color:#fff">+ Ù…Ø±Ø­Ù„Ù‡</button>

    <div style="overflow-x: auto;">
        <table id="tbl">
            <thead id="h"></thead>
            <tbody id="b"></tbody>
        </table>
    </div>
    <br>
    <button onclick="save()" style="width:100%; background:#6a1b9a; color:#fff">ğŸ’¾ Ø¯Ø§Ù†Ù„ÙˆØ¯ Ù¾Ø´ØªÛŒØ¨Ø§Ù†</button>
</div>

<script>
    var S = JSON.parse(localStorage.getItem('steps_v16')) || [];
    var P = JSON.parse(localStorage.getItem('projs_v16')) || [];

    function render() {
        localStorage.setItem('steps_v16', JSON.stringify(S));
        localStorage.setItem('projs_v16', JSON.stringify(P));
        
        var h = document.getElementById('h');
        var headHtml = '<tr><th>Ù¾Ø±ÙˆÚ˜Ù‡ <br><small>(Ø¨Ø±Ø§ÛŒ Ø§Ø¯ÛŒØª Ú©Ù„ÛŒÚ© Ú©Ù†ÛŒØ¯)</small></th>';
        for(var i=0; i<S.length; i++) {
            headHtml += '<th><span onclick="editSName('+i+')">' + S[i] + '</span><br>' +
                        '<small onclick="delS('+i+')" style="color:red; cursor:pointer;">[Ø­Ø°Ù]</small></th>';
        }
        h.innerHTML = headHtml + '</tr>';

        var b = document.getElementById('b');
        var bodyHtml = '';
        for(var j=0; j<P.length; j++) {
            var rowClass = P[j].f ? 'p-done' : '';
            bodyHtml += '<tr class="'+rowClass+'">';
            bodyHtml += '<td><b onclick="editPName('+j+')">'+P[j].n+'</b><br>' +
                        '<small onclick="tgP('+j+')" style="color:blue; cursor:pointer;">'+(P[j].f?'[Ø¨Ø§Ø²Ú¯Ø´Øª]':'[Ø§ØªÙ…Ø§Ù…]')+'</small> ' +
                        '<small onclick="delP('+j+')" style="color:red; cursor:pointer;">[Ø­Ø°Ù]</small></td>';
            for(var k=0; k<S.length; k++) {
                var d = P[j].d[k] || {t:'', f:false};
                var cellClass = d.f ? 's-done' : '';
                bodyHtml += '<td class="'+cellClass+'" onclick="ed('+j+','+k+')">'+ (d.f?'âœ… ':'') + d.t +'</td>';
            }
            bodyHtml += '</tr>';
        }
        b.innerHTML = bodyHtml;
    }

    function addP() { var v = document.getElementById('pi').value; if(v) { P.push({n:v, d:{}, f:false}); document.getElementById('pi').value='';
